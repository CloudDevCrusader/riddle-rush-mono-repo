echo "ğŸš€ Running pre-push checks..."

# Check for secrets (double-check before push)
if [ -f "scripts/check-secrets.sh" ]; then
	echo "ğŸ” Scanning for secrets..."
	chmod +x scripts/check-secrets.sh
	./scripts/check-secrets.sh || exit 1
fi

# Run type check across all packages
echo "ğŸ“˜ Type checking all packages..."
pnpm typecheck || exit 1

# Run unit tests
echo "ğŸ§ª Running unit tests..."
pnpm test:unit || exit 1

# Optional: Run syncpack check
echo "ğŸ“¦ Checking dependency versions..."
pnpm syncpack:check || {
	echo "âš ï¸  Dependency version mismatches found. Run 'pnpm syncpack:fix' to fix."
	exit 1
}

echo "âœ… Pre-push checks passed!"
