# This file controls the behavior of Trunk: https://docs.trunk.io/cli
# To learn more about the format of this file, see https://docs.trunk.io/reference/trunk-yaml
version: 0.1
cli:
  version: 1.25.0
# Trunk provides extensibility via plugins. (https://docs.trunk.io/plugins)
plugins:
  sources:
    - id: trunk
      ref: v1.7.4
      uri: https://github.com/trunk-io/plugins
# Many linters and tools depend on runtimes - configure them here. (https://docs.trunk.io/runtimes)
runtimes:
  enabled:
    - go@1.21.0
    - node@22.16.0
    - python@3.10.8
# This is the section where you manage your linters. (https://docs.trunk.io/check/configuration)
lint:
  # Ignore patterns
  ignore:
    - linters: [ALL]
      paths:
        # Binary assets
        - '**/*.png'
        - '**/*.jpg'
        - '**/*.jpeg'
        - '**/*.gif'
        - '**/*.svg'
        - '**/*.ico'
        # Build outputs
        - '**/node_modules/**'
        - '**/.nuxt/**'
        - '**/dist/**'
        - '**/build/**'
        # Test outputs
        - '**/.playwright-mcp/**'
        - '**/playwright-report/**'
        - '**/test-results/**'
        # Trunk outputs
        - '**/.trunk/**'
    - linters: [trufflehog]
      paths:
        - '**/.env*'
        - '**/pnpm-lock.yaml'
        - '**/*.md'
    - linters: [prettier]
      paths:
        - '**/.vite/stats.html'
        - '**/.circleci/**'
    - linters: [hadolint]
      paths:
        - '**/.devcontainer/**'
        - '**/.gitlab/**'
    - linters: [eslint]
      paths:
        - '**/scripts/*.js'
    - linters: [tflint]
      paths:
        - '**/variables.tf'
    - linters: [ruff, black, isort, mypy, bandit]
      paths:
        - '**/node_modules/**'
        - '**/.venv/**'
        - '**/ai/**'

  # Disable strict security scanners
  disabled:
    - trufflehog
    - osv-scanner
    - checkov

  enabled:
    - dotenv-linter@3.3.0
    - actionlint@1.7.10
    - eslint@9.39.2
    - git-diff-check
    - hadolint@2.14.0
    - markdownlint@0.47.0
    - oxipng@10.0.0
    - prettier@3.7.4
    - renovate@42.76.5
    - shellcheck@0.11.0
    - shfmt@3.6.0
    - stylelint@16.26.1
    - svgo@4.0.0
    - tflint@0.60.0
    - yamllint@1.37.1
    # Python linting tools
    - ruff@0.6.4
    - black@24.8.0
    - isort@5.13.2
    - mypy@1.11.2
    - bandit@1.7.8

  # Configure specific linters
  definitions:
    - name: shellcheck
      commands:
        - name: lint
          run: shellcheck --severity=error --exclude=SC2250,SC2248,SC2086 ${target}
    - name: markdownlint
      commands:
        - name: lint
          run: markdownlint --config .markdownlint.json ${target}
          success_codes: [0]
    - name: ruff
      commands:
        - name: lint
          run: ruff check --config=pyproject.toml ${target}
          success_codes: [0, 1]
    - name: black
      commands:
        - name: lint
          run: black --check --diff ${target}
          success_codes: [0, 1]
          output: diff
    - name: isort
      commands:
        - name: lint
          run: isort --check-only --diff ${target}
          success_codes: [0, 1]
          output: diff
    - name: mypy
      commands:
        - name: lint
          run: mypy --config-file=pyproject.toml ${target}
          success_codes: [0, 1]
    - name: bandit
      commands:
        - name: lint
          run: bandit -c pyproject.toml -r ${target}
          success_codes: [0, 1]
actions:
  disabled:
    - trunk-announce
    - trunk-check-pre-push
    - trunk-fmt-pre-commit
  enabled:
    - trunk-upgrade-available
